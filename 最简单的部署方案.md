# ğŸš€ æœ€ç®€å•çš„éƒ¨ç½²æ–¹æ¡ˆ

## ğŸ¯ æ¨èæ–¹æ¡ˆ

**Backend â†’ Railway**ï¼ˆéœ€è¦æ•°æ®åº“ï¼‰  
**Frontend â†’ Vercel**ï¼ˆé™æ€ç½‘ç«™ï¼Œæ›´å¿«æ›´ç¨³å®šï¼‰

è¿™æ ·å¯ä»¥é¿å…æ‰€æœ‰ monorepo çš„å¤æ‚é—®é¢˜ï¼

---

## âœ… ç¬¬1æ­¥ï¼šéƒ¨ç½² Backend åˆ° Railway

### 1.1 åœ¨ Railway Dashboard ä¸­

1. **åˆ é™¤å½“å‰çš„ frontend æœåŠ¡**
   - ç‚¹å‡» frontend å¡ç‰‡
   - Settings â†’ æ»šåŠ¨åˆ°åº•éƒ¨
   - "Delete Service"

2. **åªä¿ç•™ backend æœåŠ¡**
   - ç¡®è®¤ Root Directory = `backend`
   - ç¡®è®¤æœ‰ PostgreSQL æ•°æ®åº“

3. **é…ç½® Backend ç¯å¢ƒå˜é‡**
   - Variables æ ‡ç­¾
   - æ·»åŠ ï¼š
     ```
     NODE_ENV=production
     PORT=5000
     DATABASE_URL=${{Postgres.DATABASE_URL}}
     CORS_ORIGIN=*
     ```

4. **ç”Ÿæˆ Backend åŸŸå**
   - Settings â†’ Domains â†’ Generate Domain
   - **è®°å½• URL**ï¼š`_______________________________`

5. **ç­‰å¾…éƒ¨ç½²æˆåŠŸ**
   - Deployments æ ‡ç­¾
   - æŸ¥çœ‹æ—¥å¿—ç¡®è®¤æˆåŠŸ

---

## âœ… ç¬¬2æ­¥ï¼šéƒ¨ç½² Frontend åˆ° Vercel

### 2.1 å‡†å¤‡ Vercel é…ç½®

æˆ‘ä¼šå¸®ä½ åˆ›å»º `vercel.json` é…ç½®æ–‡ä»¶ã€‚

### 2.2 åœ¨ Vercel éƒ¨ç½²

1. **è®¿é—® Vercel**
   - https://vercel.com/
   - ç”¨ GitHub è´¦å·ç™»å½•

2. **å¯¼å…¥é¡¹ç›®**
   - ç‚¹å‡» "Add New..." â†’ "Project"
   - é€‰æ‹©ä½ çš„ GitHub ä»“åº“ï¼š`Haohaha-11/AllinOne`
   - ç‚¹å‡» "Import"

3. **é…ç½®é¡¹ç›®**
   - **Framework Preset**: Vite
   - **Root Directory**: `frontend` âœ…
   - **Build Command**: `npm run build`
   - **Output Directory**: `dist`

4. **æ·»åŠ ç¯å¢ƒå˜é‡**
   - ç‚¹å‡» "Environment Variables"
   - æ·»åŠ ï¼š
     ```
     Name: VITE_API_URL
     Value: ä½ çš„Railway Backend URL
     ```

5. **ç‚¹å‡» Deploy**
   - Vercel ä¼šè‡ªåŠ¨æ„å»ºå’Œéƒ¨ç½²
   - ç­‰å¾… 2-3 åˆ†é’Ÿ

6. **è·å– Frontend URL**
   - éƒ¨ç½²æˆåŠŸåä¼šæ˜¾ç¤º URL
   - **è®°å½• URL**ï¼š`_______________________________`

---

## âœ… ç¬¬3æ­¥ï¼šæ›´æ–° Backend CORS

### 3.1 åœ¨ Railway ä¸­

1. å›åˆ° Railway Dashboard
2. ç‚¹å‡» **backend** å¡ç‰‡
3. **Variables** æ ‡ç­¾
4. ä¿®æ”¹ `CORS_ORIGIN`ï¼š
   ```
   ä½ çš„Vercel Frontend URL
   ```
5. ä¿å­˜ï¼ˆä¼šè‡ªåŠ¨é‡æ–°éƒ¨ç½²ï¼‰

---

## âœ… ç¬¬4æ­¥ï¼šè¿è¡Œæ•°æ®åº“è¿ç§»

### 4.1 è·å–æ•°æ®åº“ URL

1. Railway â†’ ç‚¹å‡» **Postgres** å¡ç‰‡
2. Variables æ ‡ç­¾
3. å¤åˆ¶ `DATABASE_URL`

### 4.2 æœ¬åœ°è¿è¡Œè¿ç§»

```bash
set DATABASE_URL=ä½ å¤åˆ¶çš„æ•°æ®åº“URL

cd backend

npm run db:migrate
```

**æˆåŠŸæ ‡å¿—**ï¼š
```
âœ“ Running migration: 001_initial_schema.sql
âœ“ Running migration: 002_seed_data.sql
âœ“ Running migration: 003_add_folder_description.sql
âœ“ Running migration: 004_add_search_indexes.sql
âœ“ Running migration: 005_add_status_and_notes.sql
âœ“ All migrations completed
```

---

## âœ… ç¬¬5æ­¥ï¼šæµ‹è¯•åº”ç”¨

### 5.1 åœ¨ç”µè„‘ä¸Šæµ‹è¯•

æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—®ä½ çš„ **Vercel Frontend URL**

### 5.2 åœ¨æ‰‹æœºä¸Šæµ‹è¯•

æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—®ä½ çš„ **Vercel Frontend URL**

### 5.3 æµ‹è¯•åŠŸèƒ½

- âœ… ç²˜è´´é“¾æ¥
- âœ… åˆ›å»ºæ–‡ä»¶å¤¹
- âœ… æ·»åŠ æ ‡ç­¾
- âœ… æœç´¢å†…å®¹
- âœ… æ·»åŠ ç¬”è®°

---

## ğŸ“‹ å®Œæ•´æ£€æŸ¥æ¸…å•

### Railway (Backend)
- [ ] åªæœ‰ backend æœåŠ¡ï¼ˆåˆ é™¤äº† frontendï¼‰
- [ ] Root Directory: `backend`
- [ ] éƒ¨ç½²æˆåŠŸ
- [ ] ç¯å¢ƒå˜é‡å·²é…ç½®
- [ ] åŸŸåå·²ç”Ÿæˆ
- [ ] CORS å·²æ›´æ–°ä¸º Vercel URL

### Vercel (Frontend)
- [ ] é¡¹ç›®å·²å¯¼å…¥
- [ ] Root Directory: `frontend`
- [ ] VITE_API_URL å·²é…ç½®
- [ ] éƒ¨ç½²æˆåŠŸ
- [ ] åŸŸåå·²ç”Ÿæˆ

### æ•°æ®åº“
- [ ] è¿ç§»å·²å®Œæˆ

### æµ‹è¯•
- [ ] ç”µè„‘ä¸Šå¯ä»¥è®¿é—®
- [ ] æ‰‹æœºä¸Šå¯ä»¥è®¿é—®
- [ ] æ‰€æœ‰åŠŸèƒ½æ­£å¸¸

---

## ğŸ’¡ ä¸ºä»€ä¹ˆè¿™ä¸ªæ–¹æ¡ˆæœ€å¥½

### Railway çš„é—®é¢˜
- âŒ Monorepo æ”¯æŒå¤æ‚
- âŒ Root Directory è®¾ç½®å®¹æ˜“å‡ºé”™
- âŒ Docker å’Œ nixpacks å†²çª
- âŒ æ„å»ºç¼“å­˜é—®é¢˜

### Vercel çš„ä¼˜åŠ¿
- âœ… ä¸“é—¨ä¸ºå‰ç«¯ä¼˜åŒ–
- âœ… è‡ªåŠ¨æ£€æµ‹ Vite é¡¹ç›®
- âœ… æ”¯æŒ Root Directory
- âœ… æ„å»ºé€Ÿåº¦å¿«
- âœ… CDN å…¨çƒåŠ é€Ÿ
- âœ… è‡ªåŠ¨ HTTPS
- âœ… å‡ ä¹ä¸ä¼šå‡ºé”™

### åˆ†ç¦»éƒ¨ç½²çš„å¥½å¤„
- âœ… Backend å’Œ Frontend ç‹¬ç«‹
- âœ… å„è‡ªä½¿ç”¨æœ€é€‚åˆçš„å¹³å°
- âœ… é…ç½®ç®€å•
- âœ… ä¸ä¼šäº’ç›¸å¹²æ‰°
- âœ… æ›´å®¹æ˜“è°ƒè¯•

---

## ğŸ‰ éƒ¨ç½²å®Œæˆå

ä½ çš„åº”ç”¨æ¶æ„ï¼š
```
ç”¨æˆ·
  â†“
Vercel (Frontend)
  â†“ API è¯·æ±‚
Railway (Backend + PostgreSQL)
```

ä¼˜åŠ¿ï¼š
- âœ… Frontend é€šè¿‡ Vercel CDN å¿«é€ŸåŠ è½½
- âœ… Backend åœ¨ Railway ç¨³å®šè¿è¡Œ
- âœ… æ•°æ®åº“åœ¨ Railway å®‰å…¨å­˜å‚¨
- âœ… å…¨çƒä»»ä½•åœ°æ–¹éƒ½èƒ½å¿«é€Ÿè®¿é—®

---

## ğŸ“± ä½¿ç”¨ä½“éªŒ

- âœ… åœ¨ç”µè„‘ä¸Šè®¿é—®ï¼šå¿«é€Ÿæµç•…
- âœ… åœ¨æ‰‹æœºä¸Šè®¿é—®ï¼šå¿«é€Ÿæµç•…
- âœ… éšæ—¶éšåœ°æ”¶è—å†…å®¹
- âœ… å¤šè®¾å¤‡åŒæ­¥

---

**ç°åœ¨å¼€å§‹éƒ¨ç½²å§ï¼** ğŸš€

1. å…ˆåœ¨ Railway åˆ é™¤ frontend æœåŠ¡
2. ç¡®ä¿ backend éƒ¨ç½²æˆåŠŸ
3. ç„¶åå» Vercel éƒ¨ç½² frontend
4. æœ€åæ›´æ–° CORS å’Œè¿è¡Œè¿ç§»

è¿™ä¸ªæ–¹æ¡ˆç®€å•ã€ç¨³å®šã€ä¸ä¼šå‡ºé”™ï¼
